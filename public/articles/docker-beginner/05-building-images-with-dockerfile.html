<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Images with Dockerfile - Learning Never Ends</title>
    <style>
        
        :root {
            --bg: #ffffff;
            --text: #1f2937;
            --text-light: #6b7280;
            --card-bg: #ffffff;
            --border: #e5e7eb;
            --primary: #06b6d4;
            --primary-light: #0891b2;
            --shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg: #111827;
            --text: #f9fafb;
            --text-light: #d1d5db;
            --card-bg: #1f2937;
            --border: #374151;
            --primary: #0ea5e9;
            --primary-light: #0284c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .header {
            padding: 1.96rem 0 0.98rem 0;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .hero-title {
            font-size: clamp(2.1rem, 5.6vw, 4.2rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 0.7rem;
        }

        .hero-title a {
            color: inherit;
            text-decoration: none;
        }

        .theme-toggle {
            position: fixed;
            top: 1.5rem;
            right: 2rem;
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(6, 182, 212, 0.4);
        }
    
        
        .article-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .article-post {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem 1.5rem;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            margin: 1rem 0;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        .article-post h1:first-child { 
            font-weight: 800; 
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0 0 0.5rem 0; 
            line-height: 1.2;
        }

        .article-post h1:first-child + p em {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
            display: block;
            margin-bottom: 1rem;
        }

        .article-excerpt-display {
            background: var(--card-bg);
            border-left: 4px solid var(--primary);
            padding: 1rem 1.5rem;
            margin: 1rem 0 2rem 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: var(--text-light);
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .article-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .tag {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s ease;
        }

        .tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }

        .article-post h1, .article-post h2 { 
            font-weight: 700; 
            margin: 2rem 0 1rem 0; 
            color: var(--text);
            font-size: clamp(1.2rem, 4vw, 1.8rem);
        }

        .article-post h1:first-child, .article-post h2:first-child { 
            margin-top: 0; 
        }

        .article-post p { 
            margin-bottom: 1.2rem;
            font-size: clamp(0.95rem, 2.5vw, 1.1rem);
        }

        .article-post pre {
            background: #f8fafc;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.85rem;
        }

        [data-theme="dark"] .article-post pre { 
            background: #1f2937; 
        }

        .article-post ul, .article-post ol {
            margin: 1rem 0 1rem 1.5rem;
        }

        .article-post li {
            margin-bottom: 0.5rem;
            font-size: clamp(0.95rem, 2.5vw, 1.1rem);
        }

        .plantuml-diagram {
            text-align: center;
            margin: 1.5rem 0;
        }

        .plantuml-diagram img {
            max-width: 100%;
            height: auto;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            padding: 0.5rem;
        }

        [data-theme="dark"] .plantuml-diagram img {
            background: #f8fafc;
        }

        .article-navigation {
            display: flex;
            justify-content: space-between;
            gap: 0.75rem;
            margin: 1.5rem auto;
            padding: 0 1rem;
            max-width: 800px;
        }

        .nav-link {
            display: flex;
            flex-direction: column;
            color: var(--primary);
            text-decoration: none;
            padding: 0.75rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            flex: 1;
            max-width: 48%;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
        }

        .nav-link:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.25);
        }

        .nav-label {
            font-size: 0.75rem;
            font-weight: 600;
            opacity: 0.7;
            margin-bottom: 0.25rem;
        }

        .nav-title {
            font-size: 0.85rem;
            font-weight: 700;
            line-height: 1.3;
        }

        .nav-link.prev {
            text-align: left;
        }

        .nav-link.next {
            text-align: right;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .article-content { 
                padding: 0 0.5rem; 
            }
            
            .article-post { 
                margin: 0.5rem; 
                padding: 1.5rem 1rem; 
                border-radius: 12px;
            }
            
            .article-navigation {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0 0.5rem;
                margin: 1rem auto;
            }
            
            .nav-link {
                max-width: 100%;
                padding: 1rem;
                text-align: center !important;
            }
            
            .nav-title {
                font-size: 0.9rem;
            }
            
            .header {
                padding: 1.05rem 0 0.7rem 0;
            }
            
            .hero-title {
                font-size: clamp(1.8rem, 8vw, 2.5rem);
                margin-bottom: 0.5rem;
            }
            
            .theme-toggle {
                top: 1rem;
                right: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }
            
            .article-post pre {
                font-size: 0.8rem;
                padding: 0.75rem;
                border-radius: 6px;
            }
        }

        /* Small Mobile Devices */
        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }
            
            .article-content {
                padding: 0 0.25rem;
            }
            
            .article-post {
                margin: 0.25rem;
                padding: 1rem 0.75rem;
            }
            
            .nav-link {
                padding: 0.75rem 0.5rem;
            }
            
            .theme-toggle {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <button id="themeToggle" class="theme-toggle">Dark</button>
    
    <header class="header">
        <div class="container">
            <h1 class="hero-title">
                <a href="../../index.html">Learning Never Ends</a>
            </h1>
        </div>
    </header>

    
        <nav class="article-navigation">
            
            <a href="04-running-your-first-web-server.html" class="nav-link prev">
                <div class="nav-label">← Previous</div>
                <div class="nav-title">Running Your First Web Server</div>
            </a>
            
            
            <a href="06-managing-containers.html" class="nav-link next">
                <div class="nav-label">Next →</div>
                <div class="nav-title">Managing Docker Containers</div>
            </a>
            
        </nav>
    

    <main class="article-content">
        <article class="article-post">
            <h1>Building Images with Dockerfile</h1>
<p><em>February 14, 2026</em></p>
<div class="article-excerpt-display"><em>Master creating custom Docker images with Dockerfile - from basics to optimization techniques and best practices.</em></div>

<div class="article-tags"><span class="tag">#docker</span><span class="tag">#dockerfile</span><span class="tag">#image-building</span><span class="tag">#containerization</span></div>

<p>Ready to create your own Docker images? A <strong>Dockerfile</strong> is a text file containing instructions to build a custom Docker image automatically.</p>
<p>Think of it as a <strong>recipe</strong> that tells Docker exactly how to prepare your application for containerization.</p>
<h2>What is a Dockerfile?</h2>
<p>A <strong>Dockerfile</strong> is a script containing step-by-step instructions for Docker to:</p>
<ul>
<li>Choose a base operating system</li>
<li>Install dependencies and tools  </li>
<li>Copy your application files</li>
<li>Set configuration and environment</li>
<li>Define how to run your application</li>
</ul>
<h2>Dockerfile Structure</h2>
<div class="plantuml-diagram">
                <img src="http://www.plantuml.com/plantuml/svg/PL7BQiCm4BphAxQ-nv34lfQqDe5GqWI7KWg-gFBQLQE7aLRGKlhl9NRYHFIYPNPc7xDQUUAEWbRiZZvG8xohWBsJXXX9KWYb5KTqhLG8Zq6g1lRE2lIUiPwB8-yGaZ5VM4FuHGdyC03kIBPS42JU1YSGX6qm0Ux1En7nr_u3tRGHUvwHVdfh1hu_TkptPlPO7gyshk1G43UTGaZcAQohtROsZzmZR3JlphiGzlDOkaZXTLSzbPkgDWSaAEM9jEvxAbW0n2NB58hT_gqsQwdGJxfbhCfIg5wUQrDOhRbfhheirkKf5DkoDeVJly13tq_2F3A-beOhgD07zU_cHV1azOrHgOUhDItCPlTdsyCxuGKRlLtm4e2DyPB91fnDE1zmFk1J_nMQ9cZr1m00" alt="PlantUML Diagram" style="max-width: 100%; height: auto; border: 1px solid var(--border); border-radius: 8px; margin: 1rem 0;" />
            </div><h2>Essential Dockerfile Instructions</h2>
<h3>FROM - Base Image</h3>
<pre><code class="language-dockerfile"># Use official Node.js runtime as base image
FROM node:18-alpine

# Use specific version for reproducibility  
FROM nginx:1.25.3-alpine

# Use Ubuntu for more control
FROM ubuntu:22.04
</code></pre>
<h3>WORKDIR - Set Working Directory</h3>
<pre><code class="language-dockerfile"># Set working directory inside container
WORKDIR /app

# All subsequent commands run from this directory
</code></pre>
<h3>COPY vs ADD</h3>
<pre><code class="language-dockerfile"># COPY (recommended) - simple file copying
COPY package.json ./
COPY src/ ./src/

# ADD - has additional features (tar extraction, URL download)
ADD https://example.com/file.tar.gz /tmp/
</code></pre>
<h3>RUN - Execute Commands</h3>
<pre><code class="language-dockerfile"># Install packages
RUN apt-get update &amp;&amp; apt-get install -y curl git

# Install Node.js dependencies
RUN npm install

# Chain commands for efficiency
RUN apt-get update &amp;&amp; \
    apt-get install -y python3 pip &amp;&amp; \
    pip install requirements.txt
</code></pre>
<h3>CMD vs ENTRYPOINT</h3>
<pre><code class="language-dockerfile"># CMD - default command (can be overridden)
CMD [&quot;node&quot;, &quot;server.js&quot;]
CMD [&quot;npm&quot;, &quot;start&quot;]

# ENTRYPOINT - always executed (parameters appended)
ENTRYPOINT [&quot;node&quot;, &quot;server.js&quot;]

# Combined usage
ENTRYPOINT [&quot;node&quot;]
CMD [&quot;server.js&quot;]
</code></pre>
<h2>Practical Example: Node.js Web App</h2>
<p>Let&#39;s build a complete Node.js application image:</p>
<h3>1. Create Application Files</h3>
<p><strong>package.json</strong></p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;docker-node-app&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node server.js&quot;
  },
  &quot;dependencies&quot;: {
    &quot;express&quot;: &quot;^4.18.0&quot;
  }
}
</code></pre>
<p><strong>server.js</strong></p>
<pre><code class="language-javascript">const express = require(&#39;express&#39;);
const app = express();
const PORT = 3000;

app.get(&#39;/&#39;, (req, res) =&gt; {
  res.send(&#39;&lt;h1&gt;Hello from Docker!&lt;/h1&gt;&#39;);
});

app.listen(PORT, () =&gt; {
  console.log(`Server running on port ${PORT}`);
});
</code></pre>
<h3>2. Create Dockerfile</h3>
<pre><code class="language-dockerfile"># Use official Node.js image as base
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Copy package.json first (for better caching)
COPY package.json ./

# Install dependencies
RUN npm install

# Copy application source code
COPY . .

# Expose port that app runs on
EXPOSE 3000

# Define the command to run the application
CMD [&quot;npm&quot;, &quot;start&quot;]
</code></pre>
<h3>3. Build and Run</h3>
<pre><code class="language-bash"># Build the image
docker build -t my-node-app .

# List images to verify
docker images | grep my-node-app

# Run the container
docker run -d -p 3000:3000 --name node-server my-node-app

# Test the application
curl http://localhost:3000
# Output: &lt;h1&gt;Hello from Docker!&lt;/h1&gt;
</code></pre>
<h2>Advanced Dockerfile Techniques</h2>
<h3>Multi-Stage Builds</h3>
<p>Great for reducing final image size:</p>
<pre><code class="language-dockerfile"># Stage 1: Build stage
FROM node:18-alpine AS builder
WORKDIR /app
COPY package.json ./
RUN npm install
COPY . .
RUN npm run build

# Stage 2: Production stage
FROM nginx:alpine AS production
COPY --from=builder /app/dist /usr/share/nginx/html
EXPOSE 80
CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]
</code></pre>
<h3>Environment Variables</h3>
<pre><code class="language-dockerfile"># Set environment variables
ENV NODE_ENV=production
ENV PORT=3000
ENV DATABASE_URL=mongodb://localhost:27017/myapp

# Use environment variables
EXPOSE $PORT
</code></pre>
<h3>Health Checks</h3>
<pre><code class="language-dockerfile"># Add health check
HEALTHCHECK --interval=30s --timeout=3s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1
</code></pre>
<h3>User Management</h3>
<pre><code class="language-dockerfile"># Create non-root user for security
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodejs -u 1001

# Switch to non-root user
USER nodejs
</code></pre>
<h2>Build Context and .dockerignore</h2>
<h3>Understanding Build Context</h3>
<pre><code class="language-bash"># Everything in current directory is sent to Docker daemon
docker build .

# Use specific context
docker build /path/to/app
</code></pre>
<h3>.dockerignore File</h3>
<pre><code class="language-bash"># Create .dockerignore to exclude files
node_modules
npm-debug.log
.git
.gitignore
README.md
.env
coverage/
.nyc_output
</code></pre>
<h2>Optimization Best Practices</h2>
<h3>Layer Caching</h3>
<pre><code class="language-dockerfile"># BAD - this invalidates cache for every code change
COPY . .
RUN npm install

# GOOD - dependencies cached separately
COPY package.json ./
RUN npm install
COPY . .
</code></pre>
<h3>Minimize Layers</h3>
<pre><code class="language-dockerfile"># BAD - creates multiple layers
RUN apt-get update
RUN apt-get install -y curl
RUN apt-get install -y git

# GOOD - single layer
RUN apt-get update &amp;&amp; \
    apt-get install -y curl git &amp;&amp; \
    rm -rf /var/lib/apt/lists/*
</code></pre>
<h2>Common Dockerfile Patterns</h2>
<h3>Python Application</h3>
<pre><code class="language-dockerfile">FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
CMD [&quot;python&quot;, &quot;app.py&quot;]
</code></pre>
<h3>Java Application</h3>
<pre><code class="language-dockerfile">FROM openjdk:17-jdk-slim
WORKDIR /app
COPY target/myapp.jar app.jar
EXPOSE 8080
CMD [&quot;java&quot;, &quot;-jar&quot;, &quot;app.jar&quot;]
</code></pre>
<h3>Static Website</h3>
<pre><code class="language-dockerfile">FROM nginx:alpine
COPY dist/ /usr/share/nginx/html
EXPOSE 80
CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]
</code></pre>
<h2>Troubleshooting Build Issues</h2>
<h3>Build Cache Problems</h3>
<pre><code class="language-bash"># Build without cache
docker build --no-cache -t myapp .

# Remove all build cache
docker builder prune -a
</code></pre>
<h3>Large Image Size</h3>
<pre><code class="language-bash"># Check image layers and sizes
docker history myapp:latest

# Use alpine images when possible
FROM node:18-alpine  # Much smaller than node:18
</code></pre>
<h3>Permission Issues</h3>
<pre><code class="language-bash"># Fix file permissions in Dockerfile
RUN chown -R nodejs:nodejs /app
USER nodejs
</code></pre>
<h2>Next Steps</h2>
<p>Now that you can build custom images, let&#39;s learn how to manage containers effectively in the next lesson!</p>
<p>Key takeaways:</p>
<ul>
<li>Dockerfiles automate image creation</li>
<li>Layer caching speeds up builds</li>
<li>Multi-stage builds reduce image size  </li>
<li>Security best practices prevent vulnerabilities</li>
</ul>
<hr>
<h2>References</h2>
<ul>
<li><a href="https://docs.docker.com/engine/reference/builder/">Dockerfile Reference</a></li>
<li><a href="https://docs.docker.com/develop/dev-best-practices/">Best Practices Guide</a></li>
</ul>

        </article>
    </main>

    
        <nav class="article-navigation">
            
            <a href="04-running-your-first-web-server.html" class="nav-link prev">
                <div class="nav-label">← Previous</div>
                <div class="nav-title">Running Your First Web Server</div>
            </a>
            
            
            <a href="06-managing-containers.html" class="nav-link next">
                <div class="nav-label">Next →</div>
                <div class="nav-title">Managing Docker Containers</div>
            </a>
            
        </nav>
    

    <script>
        
        let isDark = localStorage.getItem('theme') === 'dark';
        function setTheme(dark) {
            isDark = dark; // Update the isDark variable
            document.documentElement.setAttribute('data-theme', dark ? 'dark' : 'light');
            localStorage.setItem('theme', dark ? 'dark' : 'light');
            document.getElementById('themeToggle').textContent = dark ? 'Light' : 'Dark';
        }
        document.getElementById('themeToggle').addEventListener('click', () => setTheme(!isDark));
        const saved = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        setTheme(saved === 'dark' || (!saved && prefersDark));
    
    </script>
</body>
</html>